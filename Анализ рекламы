import pandas as pd
import numpy as np
#импортируем все нужное для работы
df = pd.read_csv('leads2.csv', sep=',') #загружаем файл с данными лид-форм из кабинета вк реклама
df['Телефон'] = df['Телефон'].fillna(0) #чистим пропуски номеров телефонов в файле
df['Телефон'] = df['Телефон'].values.astype(int) #переводим формат файла в числовой
xlsx = pd.ExcelFile('Для Всеволода.xlsx') #загружаем файл с номерами телефонов людей, купивших продукт из срм 
df2 = pd.read_excel(xlsx,sheet_name='купил',header=0) #выводим файл в формате датафрейма
df2 = df2.iloc[1:,:] #убираем ненужную строчку. Вообще это можно сделать с помощью skiprows в прошлой строчке, но я не разобрался какие точно строчки убирать
df2['Телефон']=df2['Телефон.1'] #в файле из срм есть две колонки, но номера телефонов только в одной. Переводим номера телефонов в правильную колонку
df2 = df2.loc[:,['Имя','Телефон']] #выбираем из файла срм только нужные данные - имя и телефон
merged_df = pd.merge(df, df2, on='Телефон') #с помощью функции мердж совмещаем два дата фрейма, оставляя только совпадающие номера телефонов
finaldf = merged_df.loc[:,'ID Кампании':'Телефон'] #убираем ненужные столбцы из получившегося файла
finaldf.to_excel('users.xlsx',index=False,sheet_name='отчет') #сохраняем файл в формате эксель
